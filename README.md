# network-auto

# Network Analysis and Visualization Tools

This repository contains a collection of Python scripts for analyzing and visualizing Cisco network switch configurations. These tools help network administrators collect, parse, and visualize network topology and interface information.

## Features

- **CDP Network Visualization**: Connect to Cisco switches via SSH, collect CDP neighbor information, and generate interactive network topology visualizations.
- **Interface Status Analysis**: Parse "show interface status" output from Cisco switches and export to Excel.
- **Port Usage Statistics**: Analyze interface data to count active ports by speed and connection type.

## Prerequisites

- Python 3.7 or higher
- Network access to Cisco switches
- SSH credentials for the switches

### Dependencies

The following Python packages are required:
- pandas >= 1.3.0 (Latest: 2.2.3)
- paramiko >= 2.7.2 (Latest: 3.5.1)
- networkx >= 2.6.3 (Latest: 3.2.1)
- pyvis >= 0.1.9 (Latest: 0.3.2)
- numpy >= 1.20.0 (Latest: 2.0.2)
- xlsxwriter >= 3.0.3 (Latest: 3.2.3)

## Installation

1. Clone this repository:
   ```
   git clone <repository-url>
   cd <repository-directory>
   ```

2. Create a virtual environment (recommended):
   ```
   python -m venv venv
   source venv/bin/activate  # On Windows: venv\Scripts\activate
   ```

3. Install the required dependencies:
   ```
   pip install -r requirements.txt
   ```

   To install the latest versions of all dependencies:
   ```
   pip install --upgrade -r requirements.txt
   ```

## Usage

### Input Format

All scripts expect a CSV file containing switch hostnames or IP addresses, one per line:
```
switch1.example.com
192.168.1.1
switch2.example.com
```

### CDP Network Plotter

This script connects to switches, collects CDP neighbor information, and creates an interactive network visualization.

```
python cdp_plotter.py
```

You will be prompted to:
1. Enter the path to the CSV file with switch names/IPs
2. Enter SSH username
3. Enter SSH password

The script will:
- Connect to each switch and collect CDP neighbor information
- Save the raw data to an Excel file (named after your CSV file with "_cdp_neighbors" suffix)
- Generate an interactive HTML network visualization (with "_cdp_network_plot" suffix)

### Interface Status Parser

This script collects and parses "show interface status" output from switches.

```
python show_int_status_parser.py
```

You will be prompted to:
1. Enter the path to the CSV file with switch names/IPs
2. Enter SSH username
3. Enter SSH password

The script will:
- Connect to each switch and collect interface status information
- Parse the output and save it to an Excel file (named after your CSV file with "_show_int_status_parsed" suffix)

### Active Ports Counter

This script analyzes the Excel files generated by the Interface Status Parser to count active ports by speed and type.

```
python active_ports_speed_type_counter.py
```

You will be prompted to:
1. Enter the path to the input Excel file (the output from show_int_status_parser.py)
2. Enter the path to save the output Excel file

The script will:
- Analyze the interface data to count active ports by speed and connection type
- Generate an Excel file with summary sheets for port speeds and types

## Output Files

- **CDP Neighbors Excel**: Contains CDP neighbor information for each switch
- **Network Plot HTML**: Interactive visualization of the network topology
- **Interface Status Excel**: Contains parsed interface status information
- **Port Count Excel**: Contains summaries of active ports by speed and type

## Example Workflow

1. Create a CSV file with your switch hostnames/IPs (e.g., `switches.csv`)
2. Run the interface status parser:
   ```
   python show_int_status_parser.py
   ```
   This generates `switches_show_int_status_parsed.xlsx`

3. Run the CDP plotter:
   ```
   python cdp_plotter.py
   ```
   This generates `switches_cdp_neighbors.xlsx` and `switches_cdp_network_plot.html`

4. Run the active ports counter:
   ```
   python active_ports_speed_type_counter.py
   ```
   Input: `switches_show_int_status_parsed.xlsx`
   Output: `switches_active_physical_intf_count.xlsx`

## Notes

- The scripts will automatically create output files with appropriate names based on the input CSV filename
- The CDP plotter generates an interactive HTML visualization that can be opened in any web browser
- All Excel files contain multiple sheets, one for each switch plus summary sheets

## Troubleshooting

- Ensure you have network connectivity to the switches
- Verify that SSH is enabled on the switches
- Check that your credentials have sufficient privileges
- For visualization issues, ensure you have a modern web browser with JavaScript enabled
